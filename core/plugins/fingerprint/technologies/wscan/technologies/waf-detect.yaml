engine: fingerprint
info:
    name: WAF Detection
    author: dwisiswant0, lu4nx
pscan:
    path: []
    expressions:
        - '"(?i)instartrequestid".bmatches(response.body)'
        - ( "(?i)access.to.this.page.has.been.denied.because.we.believe.you.are.using.automation.tool".bmatches(response.body) || "(?i)http(s)?://(www.)?perimeterx.\\w+.whywasiblocked".bmatches(response.body) || "(?i)perimeterx".bmatches(response.body) || "(?i)(..)?client.perimeterx.*/[a-zA-Z]{8,15}/*.*.js".bmatches(response.body) )
        - ( "(?i)\\bwebknight".bmatches(response.body) || "(?i)webknight".bmatches(response.body) )
        - ( "(?i)zscaler(.\\d+(.\\d+)?)?".bmatches(response.body) || "(?i)zscaler".bmatches(response.body) )
        - ( "(?i).>powered.by.fortinet<.".bmatches(response.body) || "(?i).>fortigate.ips.sensor<.".bmatches(response.body) || "(?i)fortigate".bmatches(response.body) || "(?i).fgd_icon".bmatches(response.body) || "(?i)\\AFORTIWAFSID=".bmatches(response.body) || "(?i)application.blocked.".bmatches(response.body) || "(?i).fortiGate.application.control".bmatches(response.body) || "(?i)(http(s)?)?://\\w+.fortinet(.\\w+:)?".bmatches(response.body) || "(?i)fortigate.hostname".bmatches(response.body) || "(?i)the.page.cannot.be.displayed..please.contact.[^@]+@[^@]+\\.[^@]+.for.additional.information".bmatches(response.body) )
        - '"(?i)st8(id|.wa|.wf)?.?(\\d+|\\w+)?".bmatches(response.body)'
        - '"(?i)the.request.was.rejected.because.the.url.contained.a.potentially.malicious.string".bmatches(response.body)'
        - ( "(?i)rejected.by.url.scan".bmatches(response.body) || "(?i)/rejected.by.url.scan".bmatches(response.body) )
        - ( "(?i)<h\\d>\\d{3}.forbidden<.h\\d>".bmatches(response.body) && "(?i)request.forbidden.by.administrative.rules.".bmatches(response.body) )
        - ( "(?i)\\ATS\\w{4,}=".bmatches(response.body) || "(?i)bigipserver(.i)?|bigipserverinternal".bmatches(response.body) || "(?i)^TS[a-zA-Z0-9]{3,8}=".bmatches(response.body) || "(?i)BigIP|BIG-IP|BIGIP".bmatches(response.body) || "(?i)bigipserver".bmatches(response.body) )
        - '"(?i)\\Aecdf".bmatches(response.body)'
        - ( "(?i).\\bcloudwebsec.radware.com\\b.".bmatches(response.body) || "(?i).>unauthorized.activity.has.been.detected<.".bmatches(response.body) || "(?i)with.the.following.case.number.in.its.subject:.\\d+.".bmatches(response.body) )
        - ( "(?i)varnish".bmatches(response.body) || "(?i).>.?security.by.cachewall.?<.".bmatches(response.body) || "(?i)cachewall".bmatches(response.body) || "(?i).>access.is.blocked.according.to.our.site.security.policy.<+".bmatches(response.body) )
        - ( "(?i)infosafe".bmatches(response.body) || "(?i)by.(http(s)?(.//)?)?7i24.(com|net)".bmatches(response.body) || "(?i)infosafe.\\d.\\d".bmatches(response.body) || "(?i)var.infosafekey=".bmatches(response.body) )
        - ( "(?i)error(s)?.aliyun(dun)?.(com|net)".bmatches(response.body) || "(?i)http(s)?://(www.)?aliyun.(com|net)".bmatches(response.body) )
        - ( "(?i)(\\()?apachetrafficserver((\\/)?\\d+(.\\d+(.\\d+)?)?)".bmatches(response.body) || "(?i)ats((\\/)?(\\d+(.\\d+(.\\d+)?)?))?".bmatches(response.body) )
        - ( "(?i)malcare".bmatches(response.body) || "(?i).>login.protection<.+.><.+>powered.by<.+.>(<.+.>)?(.?malcare.-.pro|blogvault)?".bmatches(response.body) || "(?i).>firewall<.+.><.+>powered.by<.+.>(<.+.>)?(.?malcare.-.pro|blogvault)?".bmatches(response.body) )
        - '"(?i)(<title>)?wts.wa(f)?(\\w+(\\w+(\\w+)?)?)?".bmatches(response.body)'
        - '"(?i)dw.inj.check".bmatches(response.body)'
        - ( "(?i)\\Acondition.intercepted".bmatches(response.body) || "(?i)\\Asessioncookie=".bmatches(response.body) )
        - ( "(?i)<img.class=.yunsuologo.".bmatches(response.body) || "(?i)yunsuo.session".bmatches(response.body) )
        - '"(?i)litespeed.web.server".bmatches(response.body)'
        - ( "(?i)[a-zA-Z0-9]{,60}.cloudfront.net".bmatches(response.body) || "(?i)cloudfront".bmatches(response.body) || "(?i)x.amz.cf.id|nguardx".bmatches(response.body) )
        - ( "(?i)sorry.{1,2}your.access.has.been.intercept(ed)?.by.anyu".bmatches(response.body) || "(?i)anyu".bmatches(response.body) || "(?i)anyu-?.the.green.channel".bmatches(response.body) )
        - ( "(?i)your.client.has.issued.a.malformed.or.illegal.request".bmatches(response.body) || "(?i)our.systems.have.detected.unusual.traffic".bmatches(response.body) || "(?i)block(ed)?.by.g.cloud.security.policy.+".bmatches(response.body) )
        - ( "(?i)(http(s)?://)(sec-waf.|www.)?didi(static|yun)?.com(/static/cloudwafstatic)?".bmatches(response.body) || "(?i)didiyun".bmatches(response.body) )
        - '"(?i)blockdos\\.net".bmatches(response.body)'
        - '"(?i)the.uri.you.submitted.has.disallowed.characters".bmatches(response.body)'
        - '"(?i)\\AX-Mapping-".bmatches(response.body)'
        - '"(?i)wt\\d*cdn".bmatches(response.body)'
        - ( "(?i)<RequestId>[0-9a-zA-Z]{16,25}<.RequestId>".bmatches(response.body) || "(?i)<Error><Code>AccessDenied<.Code>".bmatches(response.body) || "(?i)x.amz.id.\\d+".bmatches(response.body) || "(?i)x.amz.request.id".bmatches(response.body) )
        - ( "(?i)YUNDUN".bmatches(response.body) || "(?i)^yd.cookie=".bmatches(response.body) || "(?i)http(s)?.//(www\\.)?(\\w+.)?yundun(.com)?".bmatches(response.body) || "(?i)<title>.403.forbidden:.access.is.denied.{0,2}<.{0,2}title>".bmatches(response.body) )
        - ( "(?i)\\Abarra.counter.session=?".bmatches(response.body) || "(?i)(\\A|\\b)?barracuda.".bmatches(response.body) || "(?i)barracuda.networks.{1,2}inc".bmatches(response.body) )
        - '"(?i)dod.enterprise.level.protection.system".bmatches(response.body)'
        - ( "(?i)<h\\d*>secupress<.".bmatches(response.body) || "(?i)block.id.{1,2}bad.url.contents.<.".bmatches(response.body) )
        - '"(?i)aesecure.denied.png".bmatches(response.body)'
        - ( "(?i)incap_ses|visid_incap".bmatches(response.body) || "(?i)incapsula".bmatches(response.body) || "(?i)incapsula.incident.id".bmatches(response.body) )
        - ( "(?i)nexus.?guard".bmatches(response.body) || "(?i)((http(s)?://)?speresources.)?nexusguard.com.wafpage".bmatches(response.body) )
        - ( "(?i)cloudflare.ray.id.|var.cloudflare.".bmatches(response.body) || "(?i)cloudflare.nginx".bmatches(response.body) || "(?i)..cfduid=([a-z0-9]{43})?".bmatches(response.body) || "(?i)cf[-|_]ray(..)?([0-9a-f]{16})?[-|_]?(dfw|iad)?".bmatches(response.body) || "(?i).>attention.required!.\\|.cloudflare<.+".bmatches(response.body) || "(?i)http(s)?.//report.(uri.)?cloudflare.com(/cdn.cgi(.beacon/expect.ct)?)?".bmatches(response.body) || "(?i)ray.id".bmatches(response.body) || "(?i)__cfduid".bmatches(response.body) )
        - ( "(?i).>access.denied<.".bmatches(response.body) || "(?i)akamaighost".bmatches(response.body) || "(?i)ak.bmsc.".bmatches(response.body) )
        - ( "(?i)webseal.error.message.template".bmatches(response.body) || "(?i)webseal.server.received.an.invalid.http.request".bmatches(response.body) )
        - '"(?i)dotdefender.blocked.your.request".bmatches(response.body)'
        - ( "(?i).>pkSecurityModule\\W..\\WSecurity.Alert<.".bmatches(response.body) || "(?i).http(s)?.//([w]{3})?.kitnetwork.\\w".bmatches(response.body) || "(?i).>A.safety.critical.request.was.discovered.and.blocked.<.".bmatches(response.body) )
        - ( "(?i).>error.-.expressionengine<.".bmatches(response.body) || "(?i).>:.the.uri.you.submitted.has.disallowed.characters.<.".bmatches(response.body) || "(?i)invalid.(get|post).data".bmatches(response.body) )
        - '"(?i)protected.by.comodo.waf".bmatches(response.body)'
        - '"(?i)ace.xml.gateway".bmatches(response.body)'
        - ( "(?i).>barikode<.".bmatches(response.body) || "(?i)<h\\d{1}>forbidden.access<.h\\d{1}>".bmatches(response.body) )
        - ( "(?i)(request.denied.by.)?watchguard.firewall".bmatches(response.body) || "(?i)watchguard(.technologies(.inc)?)?".bmatches(response.body) )
        - ( "(?i)x.binarysec.via".bmatches(response.body) || "(?i)x.binarysec.nocache".bmatches(response.body) || "(?i)binarysec".bmatches(response.body) )
        - ( "(?i)bekchy.(-.)?access.denied".bmatches(response.body) || "(?i)(http(s)?://)(www.)?bekchy.com(/report)?".bmatches(response.body) )
        - ( "(?i)bitninja".bmatches(response.body) || "(?i)security.check.by.bitninja".bmatches(response.body) || "(?i).>visitor.anti(\\S)?robot.validation<.".bmatches(response.body) )
        - ( "(?i)apache".bmatches(response.body) || "(?i).>you.don.t.have.permission.to.access+".bmatches(response.body) || "(?i)was.not.found.on.this.server".bmatches(response.body) || "(?i)<address>apache/([\\d+{1,2}](.[\\d+]{1,2}(.[\\d+]{1,3})?)?)?".bmatches(response.body) || "(?i)<title>403 Forbidden</title>".bmatches(response.body) )
        - ( "(?i)greywizard(.\\d.\\d(.\\d)?)?".bmatches(response.body) || "(?i)grey.wizard.block".bmatches(response.body) || "(?i)(http(s)?.//)?(\\w+.)?greywizard.com".bmatches(response.body) || "(?i)grey.wizard".bmatches(response.body) )
        - '"(?i).>the.firewall.on.this.server.is.blocking.your.connection.<+".bmatches(response.body)'
        - ( "(?i)<title>access.denied(...)?viettel.waf</title>".bmatches(response.body) || "(?i)viettel.waf.system".bmatches(response.body) || "(?i)(http(s).//)?cloudrity.com(.vn)?".bmatches(response.body) )
        - ( "(?i)(http(s)?)?(://)?(www|404|bbs|\\w+)?.safedog.\\w".bmatches(response.body) || "(?i)waf(.?\\d+.?\\d+)".bmatches(response.body) )
        - '"(?i)yunjiasu.nginx".bmatches(response.body)'
        - ( "(?i).>requested.url.cannot.be.found<.".bmatches(response.body) || "(?i)proceed.to.homepage".bmatches(response.body) || "(?i)back.to.previous.page".bmatches(response.body) || "(?i)we('re|.are)?sorry.{1,2}but.the.page.you.are.looking.for.cannot".bmatches(response.body) || "(?i)reference.id.?".bmatches(response.body) || "(?i)page.has.either.been.removed.{1,2}renamed".bmatches(response.body) )
        - '"(?i)blocked.by.website.protection.from.armour".bmatches(response.body)'
        - ( "(?i)dosarrest".bmatches(response.body) || "(?i)x.dis.request.id".bmatches(response.body) )
        - ( "has.been.blocked.in.accordance.with.company.policy".bmatches(response.body) || ".>Virus.Spyware.Download.Blocked<.".bmatches(response.body) )
        - ( "(?i)this.generic.403.error.means.that.the.authenticated".bmatches(response.body) || "(?i)request.could.not.be.understood".bmatches(response.body) || "(?i)<.+>a.potentially.dangerous.request(.querystring)?.+".bmatches(response.body) || "(?i)runtime.error".bmatches(response.body) || "(?i).>a.potentially.dangerous.request.path.value.was.detected.from.the.client+".bmatches(response.body) || "(?i)asp.net.sessionid".bmatches(response.body) || "(?i)errordocument.to.handle.the.request".bmatches(response.body) || "(?i)an.application.error.occurred.on.the.server".bmatches(response.body) || "(?i)error.log.record.number".bmatches(response.body) || "(?i)error.page.might.contain.sensitive.information".bmatches(response.body) || "(?i)<.+>server.error.in.'/'.application.+".bmatches(response.body) || "(?i)\\basp.net\\b".bmatches(response.body) )
        - ( "(?i)Powerful Firewall".bmatches(response.body) || "(?i)http(s)?...tiny.cc.powerful.firewall".bmatches(response.body) )
        - ( "(?i)http(s)?.//ucloud".bmatches(response.body) || "(?i)uewaf(.deny.pages)".bmatches(response.body) )
        - ( "(?i)janusec".bmatches(response.body) || "(?i)(http(s)?\\W+(www.)?)?janusec.(com|net|org)".bmatches(response.body) )
        - ( "(?i)>Powered.by.SiteGuard.Lite<".bmatches(response.body) || "(?i)refuse.to.browse".bmatches(response.body) )
        - ( "(?i)This.request.is.blocked.by.the.SonicWALL".bmatches(response.body) || "(?i)Dell.SonicWALL".bmatches(response.body) || "(?i)\\bDell\\b".bmatches(response.body) || "(?i)Web.Site.Blocked.+\\bnsa.banner".bmatches(response.body) || "(?i)SonicWALL".bmatches(response.body) || "(?i).>policy.this.site.is.blocked<.".bmatches(response.body) )
        - ( "(?i)^jsl(_)?tracking".bmatches(response.body) || "(?i)(__)?jsluid(=)?".bmatches(response.body) || "(?i)notice.jiasule".bmatches(response.body) || "(?i)(static|www|dynamic).jiasule.(com|net)".bmatches(response.body) )
        - ( "(?i)nginx".bmatches(response.body) || "(?i)you.do(not|n.t)?.have.permission.to.access.this.document".bmatches(response.body) )
        - ( "(?i)action.that.triggered.the.service.and.blocked".bmatches(response.body) || "(?i)<h2>sorry,.you.have.been.blocked.?<.h2>".bmatches(response.body) )
        - '"(?i)dxsupport@sabre.com".bmatches(response.body)'
        - ( "(?i)generated.by.wordfence".bmatches(response.body) || "(?i)your.access.to.this.site.has.been.limited".bmatches(response.body) || "(?i).>wordfence<.".bmatches(response.body) )
        - ( "(?i).wzws.waf.cgi.".bmatches(response.body) || "(?i)wangzhan\\.360\\.cn".bmatches(response.body) || "(?i)qianxin.waf".bmatches(response.body) || "(?i)360wzws".bmatches(response.body) || "(?i)transfer.is.blocked".bmatches(response.body) )
        - '"(?i)the.requested.url.was.rejected..please.consult.with.your.administrator.".bmatches(response.body)'
        - ( "(?i)com.rsfirewall.403.forbidden".bmatches(response.body) || "(?i)com.rsfirewall.event".bmatches(response.body) || "(?i)(\\b)?rsfirewall(\\b)?".bmatches(response.body) || "(?i)rsfirewall".bmatches(response.body) )
        - ( "(?i)access.denied.-.sucuri.website.firewall".bmatches(response.body) || "(?i)sucuri.webSite.firewall.-.cloudProxy.-.access.denied".bmatches(response.body) || "(?i)questions\\?.+cloudproxy@sucuri\\.net".bmatches(response.body) || "(?i)http(s)?.\\/\\/(cdn|supportx.)?sucuri(.net|com)?".bmatches(response.body) )
        - '"(?i)\\Aal[.-]?(sess|lb)=?".bmatches(response.body)'
        - '"(?i)class=.(db)?waf.?(-row.)?>".bmatches(response.body)'
        - '"(?i)(http(s)?.//(www.)?)?365cyd.(com|net)".bmatches(response.body)'
        - ( "(?i)<h2>error<.h2>".bmatches(response.body) || "(?i)<title>error<.title>".bmatches(response.body) || "(?i)<b>error<.b>".bmatches(response.body) || "(?i)<td.class="(errormessage|error)".height="[0-9]{1,3}".width="[0-9]{1,3}">".bmatches(response.body) || "(?i)the.incident.id.(is|number.is).".bmatches(response.body) || "(?i)page.cannot.be.displayed".bmatches(response.body) || "(?i)contact.support.for.additional.information".bmatches(response.body) )
        - '"(?i).aqb_cc.error.".bmatches(response.body)'
        - ( "(?i)ModSecurity|NYOB".bmatches(response.body) || "(?i)mod_security".bmatches(response.body) || "(?i)this.error.was.generated.by.mod.security".bmatches(response.body) || "(?i)web.server at".bmatches(response.body) || "(?i)page.you.are.(accessing|trying)?.(to|is)?.(access)?.(is|to)?.(restricted)?".bmatches(response.body) || "(?i)blocked.by.mod.security".bmatches(response.body) )
        - ( "(?i)not.acceptable".bmatches(response.body) || "(?i)additionally\\S.a.406.not.acceptable".bmatches(response.body) )
        - ( "(?i)squid".bmatches(response.body) || "(?i)Access control configuration prevents".bmatches(response.body) || "(?i)X.Squid.Error".bmatches(response.body) )
        - ( "(?i)blocked.by.the.shield".bmatches(response.body) || "(?i)transgression(\\(s\\))?.against.this".bmatches(response.body) || "(?i)url.{1,2}form.or.cookie.data.wasn.t.appropriate".bmatches(response.body) )
        - '"(?i)nginix.wallarm".bmatches(response.body)'
        - '( "(?)content="CloudWAF"".bmatches(response.body) && "Server: CloudWAF".bmatches(response.body) && "Set-Cookie: HWWAFSESID=".bmatches(response.body) )'
